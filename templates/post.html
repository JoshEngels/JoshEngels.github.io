{% extends "base.html" %}

{% block title %}{{ post.meta.title }} - Josh Engels{% endblock %}

{% block description %}{{ post.meta.description }}{% endblock %}

{% block header %}
<header>
    <nav>
        <div class="site-name heading-font">Josh Engels &mdash; <a href="{{ '../' if not is_index else '' }}">home
                page</a>
        </div>
    </nav>
</header>
{% endblock %}

{% block left_column %}
{% if toc %}
<nav id="toc" class="table-of-contents">
    <hr class="toc-separator">
    <ul>
        {% for item in toc %}
        <li class="toc-h{{ item.level }}">
            <a href="#{{ item.id }}">{{ item.text }}</a>
        </li>
        {% endfor %}
    </ul>
    <hr class="toc-separator">
</nav>
{% endif %}
{% endblock %}

{% block content %}
<article>
    <h2 class="post-title">{{ post.meta.title }}</h2>
    <div class="post-meta">
        {% if post.meta.coauthors %}
        <p>Co-authored with: <strong>{{ post.meta.coauthors | join(', ') }}</strong></p>
        {% endif %}
        <p>
            <time datetime="{{ post.meta.date }}">{{ post.meta.date | format_date }}</time>
            &middot; {% if post.meta.word_count < 1000 %}{{ post.meta.word_count }} words{% else %}{{
                (post.meta.word_count / 1000) | round(1) }}k words{% endif %} &middot; {{ (post.meta.word_count / 200) |
                round | int }} minute read </p>
                <!-- <p class="post-summary"> <strong>Summary</strong>: {{ post.meta.description }}</p> -->
    </div>

    {% if toc %}
    <div class="collapsed-sidebar">
        <nav id="collapsed-toc" class="table-of-contents">
            <hr class="toc-separator">
            <ul>
                {% for item in toc %}
                <li class="toc-h{{ item.level }}">
                    <a href="#{{ item.id }}">{{ item.text }}</a>
                </li>
                {% endfor %}
            </ul>
            <hr class="toc-separator">
        </nav>
    </div>
    {% endif %}

    <div class="post-content">
        {{ post_content | safe }}

        {% if photo_groups %}
        <div class="photo-gallery">
            {% for group in photo_groups %}
            <details class="photo-group">
                <summary class="photo-group-title">
                    {{ group.name }} <span class="photo-count">({{ group.count }} photos)</span>
                </summary>
                <div class="photo-grid">
                    {% for photo in group.photos %}
                    <a href="{{ photo }}" target="_blank">
                        <img src="{{ photo }}" alt="Hiking photo" loading="lazy">
                    </a>
                    {% endfor %}
                </div>
            </details>
            {% endfor %}
        </div>
        {% endif %}
    </div>
    {% if post.meta.label == "todo" %}
    <style>
        .post-content img {
            width: 80%;
            height: auto;
        }
    </style>
    {% endif %}
    <div class="footer">
        {% if post.meta.sequel %}
        <p>Next: <a href="../{{ post.meta.sequel }}/">{{ get_post_title(post.meta.sequel) }}</a></p>
        {% endif %}
        {% if post.meta.prequel %}
        <p>Previous: <a href="../{{ post.meta.prequel }}/">{{ get_post_title(post.meta.prequel) }}</a></p>
        {% endif %}
        {% if post.meta.elsewhere %}
        <p><em>There may be more information or discussion related to this post elsewhere:</em></p>
        <ul>
            {% for link in post.meta.elsewhere %}
            <li><a href="{{ link }}">{{ get_domain(link) }}</a></li>
            {% endfor %}
        </ul>
        </p>
        {% endif %}
    </div>
</article>
{% endblock %}